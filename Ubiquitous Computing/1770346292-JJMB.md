---
id: 1770346292-JJMB
aliases:
  - Wireless Transport
tags:
  - University
  - UbiComp
---
	
# Transport Protocol

## TCP (Overview)
- 90% of traffic is TCP
- Send data and wait for ACK (Acknowledge) if not receive then try again
- **Pipelined Protocol**: Send multiple segmnet and wait for multiple ACK if any ACK is missing resend only that part
![TCP1.png](TCP1.png)

> **Terminologies**
> Bandwidth: How much data can be sent in 1 second (ex. 1 Gbit/s)
> Bottleneck: High bandwidth get limited by one that have lower bandwidth
> Congestion: If too many packet are send they queued up causing congestion
> Congestion Window: prevent congestion by waiting (sending less packet)

## Snoop TCP

- If data is trasmitted from AP, AP "cache" the data and if it doesn't receive ACK then AP just send it instead of sender

## Why TCP doesn't perform well in Adhoc network
- Misinterpretation of packet loss
    - Bad BER
    - Collision
    - Mobility
- Frequent path break:
    - When path break you need to re-establish the route (takes time)
    - If time taken is greater than RTO (Retransmission timeout) making TCP assume congestion -> causing wasted bandwidth
- Effect of path length
    - The longer the path, the more likely for it to break
- Misinterpretation of congestion windows
    - The congestion window may not reflect the transmission rate acceptable to new route (*tf does this mean*)
- Asymmetric link behavior
    - Bidirection link can become one-way (unidirectional) for while which could make TCP invoke congestion control algorithm.
- Multipath Routing
    - Could cause out-of-order packets which generate duplicate ACK -> weird misinterpretation.

## Classification of Solutions

![solution_tcp_adhoc.png](solution_tcp_adhoc.png)

> Left: Try to modify
> Right: Fuck it we change (Standalone application)


## End-to-End Approach

### Feedback-Based TCP (TCP-F)
- Try to minimize throughput degradation from path break
- Need support routing protocol that provide feedback to TCP sender about the path break
- Rely on routing protocol to fix the path in time.
- Sends RFN (Route Failure Network) toward sender (originated from Failure Point: FP)
- Any node that receive RFN will stop using sending packet to that path and send it in alternative path (if exists) to avoid reconfiguration process.
- When sender received RFN packet it will goes into snooze state which basically do nothing until the problem is fixed and will continue if RRN (Route reestablishment notification)

- **Pros**
    - Simple
    - Depend on intermediate node ability to detect route failure

- **Cons**
    - If there's no route back to send from FP (Failure Point)A
    - Need to update TCP library
    - Congestion window used after a new route is obtained may not reflect the transmission rate acceptable to the network.

### TCP with ELFN
- Explicit link failure notification (ELFN)
- ELFN originated from node that detect path break can do 2 ways:
    - Sending ICMP(Internet Control Message Protocol) to destination and DUR (Destination unreachable) message to sender
    - Piggy-back on RERR message that is to be sent to sender
- When ELFN is received sender disable re-transmission timers and enter "standby" state.
    - Periodically probe to see if new route is established

- **Pros**
    - Simple (Use thing we already have)
    - Use ELFN to differentiate path break and congestion
    - Less dependent on routing protocol 
- **Cons**
    - If network is (temporarily) partitioned -> periodic probing eating up the bandwidth.
    - Have additional state compare to normal TCP so we need to update TCP library (*No shit??*)
    - Congestion window used after a new route is obtained may not reflect the transmission rate acceptable to the network.

### TCP-BuS (Bad) (NOT IN EXAM BABY)
- TCP with buffering capability and sequence information
- Need ABR (associativity-based routing protocol) which is not widely accepted.
> Not scale-able

### Ad Hoc TCP (ATCP) (Quite ok)
- Have 4 State:
    - Normal: Do as normal TCP
    - Congested: Use congestion control
    - Loss: Re-transmit the lost packet, don't change congestion window
    - Disconnected: Freeze and wait util it receive ACK
- If intermediate node think that the network is partitioned, TCP sender changed to 
- Use explicit congestion notification (ECN)
- Don't have to modify tradition TCP (Is a thin layer between network layer and TCP Layer)
- **Pros**
    - Improve throughput
    - Maintain end-to-end  semantics (privacy is not violated).
    - Is just additional layer of TCP so we don't have to update TCP code
    - Work seamlessly with the internet
- **Cons**
    - Dependent on network layer(DSR, AODV, etc) protocol to detect the route change and partition
    - Need to update

## Split Approach

### Split TCP
- "*People don't want MitM to be our proxy and make packet on our behalf*"
- Split long TCP connection into short connections called "zones" and the intermediate node are "proxy"
- Use local ACK (LACK) for each zone
- Use congestion window and end-to-end window (*tf does this mean*)
- **Pros**
    - Improve throughput, fariness
    - Lessened impact of mobility
- **Cons**
    - Need to update TCP
    - Failure of proxy node can cause throughput degradation
    - No E2E semantics -> bad for privacy

## Other transport layer protocol

### ATP: Ad hoc transport protocol
- Not TCP, a completely new thing
- Motivation
    - Window based transmission: TCP relies on self-clocking, inducing bursty-ness of traffic which cause
        - Varying RTT (Round trip time): Make RTO values inflated -> Delayed loss recovery
        - Higher induced loads: Burst cause higher contention at MAC layer
    - Slow start (for TCP) probe for bandwidth
        - Under-utilization
        - Unfairness
    - Loss-based congestion
        - Most loss in adhoc networks are from route failures
    - Multiplicative decrease
        - Not good when route change happened
    - Reliance on reverse path
        - TCP relies on ACK
        - In adhoc we use RTS, CTS and ACK in CSMA/CA making TCP ACKs kinda useless eating bandwidth
- **Features**
    - No slow start (Estimate start-up rate)
    - Have progressive rate feedback for congestion detection, avoidance, control

- **How**
    - Maintain sum of average queuing delay and average transmission delay:
    - Each packet have rate feedback field (D)
![maintain_sum_avg.png](maintain_sum_avg.png)

    - Flow control: Maintain good rate feedback (Less than application read rate at the receiver)
![Feedback.png](Feedback.png)

Use select ACK (SACKs) to provide information about loss

- **Procedure**
1. Quick Start
    - Probe the available bandwidth
    - Use TCP-like (SYN-SYN-ACK) protocol to get the rate feedback
2. Congestion Control
    - Increase: If feedback rate > current rate
    - Decrease: feedback rate < current rate
    - Maintain phase: feedback rate = current rate
3. Reliability
    - Use ELFN for path failure notification

- **Pros**
    - Improved performance
    - Decoupling congestion control & reliability
    - Does not maintain any per flow state at IN
    - Avoidance of congestion window
    - Congestion info is gathered directed from IN
- **Cons**
    - Not compatible with TCP
    - Scalability bottleneck in large ad hoc network

